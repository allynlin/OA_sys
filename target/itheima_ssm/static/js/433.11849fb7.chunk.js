"use strict";(self.webpackChunkdemo_ts=self.webpackChunkdemo_ts||[]).push([[433],{5433:function(e,n,t){t.r(n),t.d(n,{default:function(){return C}});var s=t(1413),r=t(3433),i=t(9439),a=t(2380),o=t(7947),c=t(3695),l=t(7138),u=t(7063),d=t(7309),f=t(3430),p=t(9389),m=t(8042),h=t(6776),Z=t(2791),x=t(7689),j=t(607),g=t(8329),b=t(184),y=a.Z.Title,v=g.Z.get("token"),k=function(){var e=(0,x.s0)(),n=(0,Z.useState)(!1),t=(0,i.Z)(n,2),a=t[0],g=t[1],k=(0,Z.useState)(9),C=(0,i.Z)(k,2),F=C[0],S=C[1],w=(0,Z.useState)([]),N=(0,i.Z)(w,2),P=N[0],T=N[1],I=(0,Z.useState)(!1),L=(0,i.Z)(I,2),D=L[0],U=L[1],q=(0,Z.useState)(!1),W=(0,i.Z)(q,2),z=W[0],R=W[1],_=(0,Z.useState)(!0),A=(0,i.Z)(_,2),E=A[0],M=A[1],O=(0,Z.useState)("\u6b63\u5728\u83b7\u53d6\u90e8\u95e8\u53d8\u66f4\u7533\u8bf7\u8bb0\u5f55"),H=(0,i.Z)(O,2),V=H[0],B=H[1],G=(0,Z.useState)([]),J=(0,i.Z)(G,2),K=J[0],Q=J[1],X=o.Z.useForm(),Y=(0,i.Z)(X,1)[0],$=o.Z.useWatch("departmentUid",Y),ee=o.Z.useWatch("changeReason",Y);o.Z.useWatch("file",Y);(0,Z.useEffect)((function(){ne()}),[]),(0,Z.useEffect)((function(){var e=setTimeout((function(){F>1?(g(!0),S((function(e){return e-1})),g(!0)):g(!1)}),1e3);return function(){clearTimeout(e)}}),[F]);var ne=function(){g(!0),S(10),a||(0,j.e8)().then((function(e){200===e.code?(M(!1),te()):(c.ZP.warning(e.msg),B("\u60a8\u5df2\u7ecf\u63d0\u4ea4\u8fc7\u90e8\u95e8\u53d8\u66f4\u7533\u8bf7\uff0c\u8bf7\u7b49\u5f85\u5ba1\u6279\u7ed3\u679c"))}))},te=function(){(0,j.HO)("changedepartmentbyteacher").then((function(e){if(200===e.code){var n=e.body.map((function(e){return{uid:e.uid,name:e.oldFileName,status:"done",url:"D:/upload/".concat(e.FileName)}}));T(n)}}))},se={name:"file",headers:{Authorization:"".concat(v),tableUid:"changedepartmentbyteacher"},multiple:!0,action:"http://localhost:8086/cshbxy/api/uploadFile",fileList:P,beforeUpload:function(e){return!(e.size/1024/1024>20)||(c.ZP.warning("\u6587\u4ef6\u5927\u5c0f\u4e0d\u80fd\u8d85\u8fc7 20M"),e.status="error",!1)},onChange:function(e){var n=e.file.status;if(T((0,r.Z)(e.fileList)),"uploading"!==n&&console.log(e.file,e.fileList),"done"===n)if(200===e.file.response.code){c.ZP.success(e.file.response.msg);var t=P.map((function(n){return n.uid===e.file.uid&&(n.url="D:/Upload/".concat(e.file.response.body),n.status="done",n.uid=e.file.response.body),n}));T(t)}else c.ZP.error(e.file.response.msg);else"error"===n&&c.ZP.error("".concat(e.file.name," \u6587\u4ef6\u4e0a\u4f20\u5931\u8d25"))},onDrop:function(e){console.log("Dropped files",e.dataTransfer.files)},onRemove:function(e){if("done"===e.status){var n=e.uid;(0,j._I)(n).then((function(e){c.ZP.success(e.msg)}))}},progress:{strokeColor:{"0%":"#108ee9","100%":"#87d068"},strokeWidth:3,format:function(e){return e&&"".concat(parseFloat(e.toFixed(2)),"%")}}},re=function(){return(0,b.jsxs)(l.Z,{title:"Title",open:z,onOk:ae,confirmLoading:D,onCancel:ie,children:[(0,b.jsxs)("p",{children:["\u53d8\u66f4\u90e8\u95e8\uff1a",$]}),(0,b.jsxs)("p",{children:["\u53d8\u66f4\u539f\u56e0\uff1a",ee]}),(0,b.jsxs)("p",{children:["\u53d8\u66f4\u6750\u6599\uff1a",P.filter((function(e){return"done"===e.status})).map((function(e){return e.name})).join("\u3001")]})]})},ie=function(){R(!1)},ae=function(){U(!0),(0,j.VS)($,ee).then((function(n){U(!1),c.ZP.success(n.msg),e("/home")})).catch((function(e){U(!1)}))};return E?(0,b.jsx)(u.ZP,{status:"warning",title:V,extra:(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(d.Z,{type:"primary",onClick:function(){e("/record/leaveList",{replace:!0})},children:"\u67e5\u770b\u90e8\u95e8\u53d8\u66f4\u7533\u8bf7\u8bb0\u5f55"},"console"),(0,b.jsx)(d.Z,{type:"primary",onClick:function(){ne()},disabled:a,children:a?"\u8bf7\u7b49\u5f85".concat(F,"\u79d2\u540e\u53ef\u4ee5\u5237\u65b0"):"\u5237\u65b0"},"buy")]})}):(0,b.jsxs)("div",{className:"body",children:[(0,b.jsx)(re,{}),(0,b.jsxs)("div",{className:"zent-alert-example",children:[(0,b.jsx)(y,{level:2,className:"tit",children:"\u90e8\u95e8\u53d8\u66f4\u7533\u8bf7"}),(0,b.jsxs)(o.Z,{form:Y,name:"basic",labelCol:{span:8},wrapperCol:{span:16},onFinish:function(e){R(!0)},children:[(0,b.jsx)(o.Z.Item,{label:"\u53d8\u66f4\u90e8\u95e8",name:"departmentUid",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u4f60\u9700\u8981\u53d8\u66f4\u7684\u65b0\u90e8\u95e8"}],children:(0,b.jsx)(f.Z,{showSearch:!0,placeholder:"\u8bf7\u9009\u62e9\u4f60\u9700\u8981\u53d8\u66f4\u7684\u65b0\u90e8\u95e8",optionFilterProp:"children",onFocus:function(){(0,j.qI)().then((function(e){var n=e.body.map((function(e){return{value:e.uid,label:e.realeName}}));Q(n)}))},options:K})}),(0,b.jsx)(o.Z.Item,{label:"\u53d8\u66f4\u539f\u56e0",name:"changeReason",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u53d8\u66f4\u539f\u56e0"}],children:(0,b.jsx)(p.Z.TextArea,{rows:4,placeholder:"\u8bf7\u8f93\u5165\u53d8\u66f4\u539f\u56e0"})}),(0,b.jsx)(o.Z.Item,{label:"\u53d8\u66f4\u6750\u6599",name:"file",rules:[{required:!1,message:"\u8bf7\u4e0a\u4f20\u53d8\u66f4\u6750\u6599"}],children:(0,b.jsxs)(m.Z.Dragger,(0,s.Z)((0,s.Z)({},se),{},{children:[(0,b.jsx)("p",{className:"ant-upload-drag-icon",children:(0,b.jsx)(h.Z,{})}),(0,b.jsx)("p",{className:"ant-upload-text",children:"\u5355\u51fb\u6216\u62d6\u52a8\u6587\u4ef6\u5230\u6b64\u533a\u57df\u8fdb\u884c\u4e0a\u4f20"}),(0,b.jsx)("p",{className:"ant-upload-hint",children:"\u652f\u6301\u5355\u4e2a\u6216\u6279\u91cf\u4e0a\u4f20\uff08\u5355\u6587\u4ef6\u4e0d\u8d85\u8fc7 20M\uff09"})]}))}),(0,b.jsxs)(o.Z.Item,{wrapperCol:{offset:8,span:16},children:[(0,b.jsx)(d.Z,{type:"primary",htmlType:"submit",children:"\u63d0\u4ea4"}),(0,b.jsx)(d.Z,{htmlType:"button",onClick:function(){Y.resetFields()},style:{marginLeft:8},children:"\u91cd\u7f6e"})]})]})]})]})},C=function(){return(0,b.jsx)(k,{})}}}]);
//# sourceMappingURL=433.11849fb7.chunk.js.map