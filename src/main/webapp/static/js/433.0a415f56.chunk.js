"use strict";(self.webpackChunkdemo_ts=self.webpackChunkdemo_ts||[]).push([[433],{5433:function(e,n,t){t.r(n),t.d(n,{default:function(){return C}});var s=t(1413),i=t(3433),o=t(9439),a=t(2380),r=t(7947),c=t(3695),l=t(7138),u=t(7063),d=t(7309),f=t(3430),m=t(9389),p=t(8042),h=t(6776),Z=t(2791),x=t(7689),g=t(607),j=t(8329),b=t(8494),y=t(184),v=a.Z.Title,F=j.Z.get("token"),k="".concat(b.x,"/api"),w=function(){var e=(0,x.s0)(),n=(0,Z.useState)(!1),t=(0,o.Z)(n,2),a=t[0],j=t[1],b=(0,Z.useState)(9),w=(0,o.Z)(b,2),C=w[0],N=w[1],S=(0,Z.useState)([]),P=(0,o.Z)(S,2),T=P[0],I=P[1],L=(0,Z.useState)(!1),q=(0,o.Z)(L,2),U=q[0],z=q[1],D=(0,Z.useState)(!1),R=(0,o.Z)(D,2),W=R[0],_=R[1],A=(0,Z.useState)(!0),E=(0,o.Z)(A,2),M=E[0],O=E[1],H=(0,Z.useState)("\u6b63\u5728\u83b7\u53d6\u90e8\u95e8\u53d8\u66f4\u7533\u8bf7\u8bb0\u5f55"),V=(0,o.Z)(H,2),B=V[0],G=V[1],J=(0,Z.useState)([]),K=(0,o.Z)(J,2),Q=K[0],X=K[1],Y=r.Z.useForm(),$=(0,o.Z)(Y,1)[0],ee=r.Z.useWatch("departmentUid",$),ne=r.Z.useWatch("changeReason",$);(0,Z.useEffect)((function(){te()}),[]),(0,Z.useEffect)((function(){var e=setTimeout((function(){C>1?(j(!0),N((function(e){return e-1})),j(!0)):j(!1)}),1e3);return function(){clearTimeout(e)}}),[C]);var te=function(){j(!0),N(10),a||(0,g.e8)().then((function(e){200===e.code?(O(!1),se()):(c.ZP.warning(e.msg),G("\u60a8\u5df2\u7ecf\u63d0\u4ea4\u8fc7\u90e8\u95e8\u53d8\u66f4\u7533\u8bf7\uff0c\u8bf7\u7b49\u5f85\u5ba1\u6279\u7ed3\u679c"))}))},se=function(){(0,g.HO)("changedepartmentbyteacher").then((function(e){if(200===e.code){console.log(e);var n=e.body.map((function(e){return{uid:e.fileName,name:e.oldFileName,status:"done",url:"".concat(k,"/downloadFile?filename=").concat(e.fileName)}}));I(n)}}))},ie={name:"file",headers:{Authorization:"".concat(F),tableUid:"changedepartmentbyteacher"},multiple:!0,action:"".concat(k,"/uploadFile"),fileList:T,beforeUpload:function(e){return!(e.size/1024/1024>20)||(c.ZP.warning("\u6587\u4ef6\u5927\u5c0f\u4e0d\u80fd\u8d85\u8fc7 20M"),e.status="error",!1)},onChange:function(e){var n=e.file.status;if(I((0,i.Z)(e.fileList)),"uploading"!==n&&console.log(e.file,e.fileList),"done"===n)if(200===e.file.response.code){c.ZP.success(e.file.response.msg);var t=T.map((function(n){return n.uid===e.file.uid&&(n.url="".concat(k,"/downloadFile?filename=").concat(e.file.response.body),n.status="done",n.uid=e.file.response.body),n}));I(t)}else c.ZP.error(e.file.response.msg);else"error"===n&&c.ZP.error("".concat(e.file.name," \u6587\u4ef6\u4e0a\u4f20\u5931\u8d25"))},onDrop:function(e){console.log("Dropped files",e.dataTransfer.files)},onRemove:function(e){if("done"===e.status){var n=e.uid;(0,g._I)(n).then((function(e){c.ZP.success(e.msg)}))}},progress:{strokeColor:{"0%":"#108ee9","100%":"#87d068"},strokeWidth:3,format:function(e){return e&&"".concat(parseFloat(e.toFixed(2)),"%")}}},oe=function(){return(0,y.jsxs)(l.Z,{title:"Title",open:W,onOk:re,confirmLoading:U,onCancel:ae,children:[(0,y.jsxs)("p",{children:["\u53d8\u66f4\u90e8\u95e8\uff1a",ee]}),(0,y.jsxs)("p",{children:["\u53d8\u66f4\u539f\u56e0\uff1a",ne]}),(0,y.jsxs)("p",{children:["\u53d8\u66f4\u6750\u6599\uff1a",T.filter((function(e){return"done"===e.status})).map((function(e){return e.name})).join("\u3001")]})]})},ae=function(){_(!1)},re=function(){z(!0),(0,g.VS)(ee,ne).then((function(n){z(!1),c.ZP.success(n.msg),e("/home")})).catch((function(e){z(!1)}))};return M?(0,y.jsx)(u.ZP,{status:"warning",title:B,extra:(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(d.Z,{type:"primary",onClick:function(){e("/record/leaveList",{replace:!0})},children:"\u67e5\u770b\u90e8\u95e8\u53d8\u66f4\u7533\u8bf7\u8bb0\u5f55"},"console"),(0,y.jsx)(d.Z,{type:"primary",onClick:function(){te()},disabled:a,children:a?"\u8bf7\u7b49\u5f85".concat(C,"\u79d2\u540e\u53ef\u4ee5\u5237\u65b0"):"\u5237\u65b0"},"buy")]})}):(0,y.jsxs)("div",{className:"body",children:[(0,y.jsx)(oe,{}),(0,y.jsxs)("div",{className:"zent-alert-example",children:[(0,y.jsx)(v,{level:2,className:"tit",children:"\u90e8\u95e8\u53d8\u66f4\u7533\u8bf7"}),(0,y.jsxs)(r.Z,{form:$,name:"basic",labelCol:{span:8},wrapperCol:{span:16},onFinish:function(e){_(!0)},children:[(0,y.jsx)(r.Z.Item,{label:"\u53d8\u66f4\u90e8\u95e8",name:"departmentUid",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u4f60\u9700\u8981\u53d8\u66f4\u7684\u65b0\u90e8\u95e8"}],children:(0,y.jsx)(f.Z,{showSearch:!0,placeholder:"\u8bf7\u9009\u62e9\u4f60\u9700\u8981\u53d8\u66f4\u7684\u65b0\u90e8\u95e8",optionFilterProp:"children",onFocus:function(){(0,g.qI)().then((function(e){var n=e.body.map((function(e){return{value:e.uid,label:e.realeName}}));X(n)}))},options:Q})}),(0,y.jsx)(r.Z.Item,{label:"\u53d8\u66f4\u539f\u56e0",name:"changeReason",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u53d8\u66f4\u539f\u56e0"}],children:(0,y.jsx)(m.Z.TextArea,{rows:4,placeholder:"\u8bf7\u8f93\u5165\u53d8\u66f4\u539f\u56e0"})}),(0,y.jsx)(r.Z.Item,{label:"\u53d8\u66f4\u6750\u6599",name:"file",rules:[{required:!1,message:"\u8bf7\u4e0a\u4f20\u53d8\u66f4\u6750\u6599"}],children:(0,y.jsxs)(p.Z.Dragger,(0,s.Z)((0,s.Z)({},ie),{},{children:[(0,y.jsx)("p",{className:"ant-upload-drag-icon",children:(0,y.jsx)(h.Z,{})}),(0,y.jsx)("p",{className:"ant-upload-text",children:"\u5355\u51fb\u6216\u62d6\u52a8\u6587\u4ef6\u5230\u6b64\u533a\u57df\u8fdb\u884c\u4e0a\u4f20"}),(0,y.jsx)("p",{className:"ant-upload-hint",children:"\u652f\u6301\u5355\u4e2a\u6216\u6279\u91cf\u4e0a\u4f20\uff08\u5355\u6587\u4ef6\u4e0d\u8d85\u8fc7 20M\uff09"})]}))}),(0,y.jsxs)(r.Z.Item,{wrapperCol:{offset:8,span:16},children:[(0,y.jsx)(d.Z,{type:"primary",htmlType:"submit",children:"\u63d0\u4ea4"}),(0,y.jsx)(d.Z,{htmlType:"button",onClick:function(){$.resetFields()},style:{marginLeft:8},children:"\u91cd\u7f6e"})]})]})]})]})},C=function(){return(0,y.jsx)(w,{})}}}]);
//# sourceMappingURL=433.0a415f56.chunk.js.map